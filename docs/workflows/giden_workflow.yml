# GIDEN Workflow - GeraÃ§Ã£o Inteligente de DocumentaÃ§Ã£o
# Symbiotic Ethical Vision Engine
# Developed by EON Team - Symbeon Tech

name: GIDEN - Intelligent Documentation Generation

on:
  push:
    branches: [ main, develop ]
    paths:
      - 'src/**'
      - 'tests/**'
      - 'examples/**'
  pull_request:
    branches: [ main ]
    paths:
      - 'src/**'
      - 'tests/**'
      - 'examples/**'
  schedule:
    - cron: '0 10 * * *'  # Daily at 10 AM

jobs:
  giden-analysis:
    runs-on: ubuntu-latest
    name: GIDEN - Code Analysis
    
    steps:
    - name: Checkout Repository
      uses: actions/checkout@v4
      with:
        fetch-depth: 0
    
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
    
    - name: Install GIDEN
      run: |
        pip install giden
        pip install -r requirements.txt
    
    - name: Configure GIDEN
      run: |
        cp giden.yaml .giden.yaml
        echo "GIDEN configured for SEVE Framework"
    
    - name: Run Code Analysis
      run: |
        giden analyze --config .giden.yaml --verbose --output analysis_report.json
    
    - name: Extract Documentation Elements
      run: |
        giden extract --config .giden.yaml --elements classes,functions,examples,configs
    
    - name: Upload Analysis Report
      uses: actions/upload-artifact@v3
      with:
        name: giden-analysis
        path: analysis_report.json

  giden-generation:
    runs-on: ubuntu-latest
    name: GIDEN - Documentation Generation
    needs: giden-analysis
    
    steps:
    - name: Checkout Repository
      uses: actions/checkout@v4
    
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
    
    - name: Install GIDEN
      run: |
        pip install giden
        pip install -r requirements.txt
    
    - name: Download Analysis Report
      uses: actions/download-artifact@v3
      with:
        name: giden-analysis
        path: ./
    
    - name: Generate Module Documentation
      run: |
        giden generate --config giden.yaml --template module --input analysis_report.json
    
    - name: Generate API Documentation
      run: |
        giden generate --config giden.yaml --template api --input analysis_report.json
    
    - name: Generate Tutorials
      run: |
        giden generate --config giden.yaml --template tutorial --input analysis_report.json
    
    - name: Generate Examples Documentation
      run: |
        giden generate --config giden.yaml --template examples --input analysis_report.json
    
    - name: Validate Generated Documentation
      run: |
        giden validate --config giden.yaml --strict --coverage 0.90
    
    - name: Upload Generated Documentation
      uses: actions/upload-artifact@v3
      with:
        name: generated-docs
        path: docs/

  giden-quality:
    runs-on: ubuntu-latest
    name: GIDEN - Quality Assurance
    needs: giden-generation
    
    steps:
    - name: Checkout Repository
      uses: actions/checkout@v4
    
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
    
    - name: Install GIDEN
      run: |
        pip install giden
        pip install -r requirements.txt
    
    - name: Download Generated Documentation
      uses: actions/download-artifact@v3
      with:
        name: generated-docs
        path: ./
    
    - name: Run Quality Checks
      run: |
        giden quality-check --config giden.yaml --threshold 0.85
    
    - name: Run Readability Check
      run: |
        giden readability-check --config giden.yaml --min-score 0.80
    
    - name: Run Completeness Check
      run: |
        giden completeness-check --config giden.yaml --coverage 0.90
    
    - name: Run Consistency Check
      run: |
        giden consistency-check --config giden.yaml --strict
    
    - name: Generate Quality Report
      run: |
        giden report --config giden.yaml --format markdown > giden_quality_report.md
    
    - name: Upload Quality Report
      uses: actions/upload-artifact@v3
      with:
        name: giden-quality-report
        path: giden_quality_report.md

  giden-ai-enhancement:
    runs-on: ubuntu-latest
    name: GIDEN - AI Enhancement
    needs: giden-generation
    
    steps:
    - name: Checkout Repository
      uses: actions/checkout@v4
    
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
    
    - name: Install GIDEN with AI
      run: |
        pip install giden[ai]
        pip install -r requirements.txt
    
    - name: Download Generated Documentation
      uses: actions/download-artifact@v3
      with:
        name: generated-docs
        path: ./
    
    - name: AI Enhancement
      run: |
        giden enhance --config giden.yaml --ai-model gpt-4 --enhancement-level high
    
    - name: AI Quality Check
      run: |
        giden ai-quality-check --config giden.yaml --model gpt-4
    
    - name: Generate AI Report
      run: |
        giden ai-report --config giden.yaml --format markdown > giden_ai_report.md
    
    - name: Upload AI Report
      uses: actions/upload-artifact@v3
      with:
        name: giden-ai-report
        path: giden_ai_report.md

  giden-deployment:
    runs-on: ubuntu-latest
    name: GIDEN - Documentation Deployment
    needs: [giden-quality, giden-ai-enhancement]
    if: github.ref == 'refs/heads/main'
    
    steps:
    - name: Checkout Repository
      uses: actions/checkout@v4
    
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
    
    - name: Install GIDEN
      run: |
        pip install giden
        pip install -r requirements.txt
    
    - name: Download Generated Documentation
      uses: actions/download-artifact@v3
      with:
        name: generated-docs
        path: ./
    
    - name: Deploy to GitHub Pages
      run: |
        giden deploy --config giden.yaml --platform github-pages --auto-deploy
    
    - name: Deploy to ReadTheDocs
      run: |
        giden deploy --config giden.yaml --platform readthedocs --auto-build
    
    - name: Generate Deployment Report
      run: |
        giden deployment-report --config giden.yaml --format markdown > deployment_report.md
    
    - name: Upload Deployment Report
      uses: actions/upload-artifact@v3
      with:
        name: deployment-report
        path: deployment_report.md

  giden-notification:
    runs-on: ubuntu-latest
    name: GIDEN - Notifications
    needs: [giden-analysis, giden-generation, giden-quality, giden-ai-enhancement]
    if: always()
    
    steps:
    - name: Notify Success
      if: ${{ needs.giden-analysis.result == 'success' && needs.giden-generation.result == 'success' && needs.giden-quality.result == 'success' }}
      run: |
        echo "âœ… GIDEN completed successfully"
        echo "ğŸ“š Documentation generated and enhanced"
        echo "ğŸ¯ Quality thresholds met"
        echo "ğŸ¤– AI enhancements applied"
    
    - name: Notify Failure
      if: ${{ needs.giden-analysis.result == 'failure' || needs.giden-generation.result == 'failure' || needs.giden-quality.result == 'failure' }}
      run: |
        echo "âŒ GIDEN failed"
        echo "ğŸ” Check logs for details"
        exit 1
